{"ast":null,"code":"import jwt from \"jsonwebtoken\"; // functions for authentication\n\nexport function isLoggedIn() {\n  const token = localStorage.getItem(\"token\");\n  return token != null;\n}\nexport function logout() {\n  if (isLoggedIn()) {\n    //localStorage.clear();\n    localStorage.removeItem(\"token\");\n  }\n} // to save the token to the browsers localstorage which\n// will keep the session active\n\nexport function setToken(token) {\n  if (getToken() === token) {\n    localStorage.clear();\n    localStorage.setItem(\"token\", token);\n  }\n\n  localStorage.setItem(\"token\", token);\n}\nexport function getToken() {\n  return localStorage.getItem(\"token\");\n}\nexport function decodeToken() {\n  const token = getToken();\n\n  if (!token) {\n    return null;\n  }\n\n  const decodedToken = jwt.decode(token);\n  console.log(\"decoded token:\");\n  console.log(decodedToken);\n  return decodedToken;\n} // User info decoded from Token\n\nexport function getUserId() {\n  // decrypt token to its original data\n  const token = decodeToken();\n\n  if (!token) {\n    return null;\n  }\n\n  return token.id;\n}\nexport function getUserEmail() {\n  // decrypt token to its original data\n  const token = decodeToken();\n\n  if (!token) {\n    return null;\n  }\n\n  return token.email;\n}\nexport function getUserFirstName() {\n  // decrypt token to its original data\n  const token = decodeToken();\n\n  if (!token) {\n    return \"User\";\n  }\n\n  return token.firstName;\n}\nexport function getUserLastName() {\n  // decrypt token to its original data\n  const token = decodeToken();\n\n  if (!token) {\n    return null;\n  }\n\n  return token.lastName;\n}\nexport default {\n  signin: user => {\n    console.log(user);\n    return fetch('/user/signin', {\n      method: 'post',\n      body: JSON.stringify(user),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(res => {\n      if (res.status !== 401) return res.json().then(data => data);else return {\n        isAuthenticated: false,\n        user: {\n          email: ''\n        }\n      };\n    });\n  },\n  signup: user => {\n    console.log(user);\n    return fetch('/user/signup', {\n      method: 'post',\n      body: JSON.stringify(user),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(res => res.json()).then(data => data);\n  },\n  signout: () => {\n    return fetch('/user/signout').then(res => res.json()).then(data => data);\n  },\n  isAuthenticated: () => {\n    return fetch('/user/authenticated').then(res => {\n      if (res.status !== 401) return res.json().then(data => data);else return {\n        isAuthenticated: false,\n        user: {\n          username: '',\n          role: ''\n        }\n      };\n    });\n  }\n};","map":{"version":3,"sources":["/Users/benjamin/School/NewsApp/frontend/src/components/auth.js"],"names":["jwt","isLoggedIn","token","localStorage","getItem","logout","removeItem","setToken","getToken","clear","setItem","decodeToken","decodedToken","decode","console","log","getUserId","id","getUserEmail","email","getUserFirstName","firstName","getUserLastName","lastName","signin","user","fetch","method","body","JSON","stringify","headers","then","res","status","json","data","isAuthenticated","signup","signout","username","role"],"mappings":"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","sourcesContent":["import jwt from \"jsonwebtoken\";\n\n// functions for authentication\nexport function isLoggedIn() {\n  const token = localStorage.getItem(\"token\");\n  return token != null;\n}\n\nexport function logout() {\n  if (isLoggedIn()) {\n    //localStorage.clear();\n    localStorage.removeItem(\"token\");\n  }\n}\n\n// to save the token to the browsers localstorage which\n// will keep the session active\nexport function setToken(token) {\n  if (getToken() === token) {\n    localStorage.clear();\n    localStorage.setItem(\"token\", token);\n  }\n  localStorage.setItem(\"token\", token);\n}\n\nexport function getToken() {\n  return localStorage.getItem(\"token\");\n}\n\nexport function decodeToken() {\n  const token = getToken();\n  if (!token) {\n    return null;\n  }\n  const decodedToken = jwt.decode(token);\n  console.log(\"decoded token:\");\n  console.log(decodedToken);\n  return decodedToken;\n}\n\n// User info decoded from Token\nexport function getUserId() {\n  // decrypt token to its original data\n  const token = decodeToken();\n  if (!token) {\n    return null;\n  }\n  return token.id;\n}\n\nexport function getUserEmail() {\n  // decrypt token to its original data\n  const token = decodeToken();\n  if (!token) {\n    return null;\n  }\n  return token.email;\n}\nexport function getUserFirstName() {\n  // decrypt token to its original data\n\n  const token = decodeToken();\n  if (!token) {\n    return \"User\";\n  }\n  return token.firstName;\n}\nexport function getUserLastName() {\n  // decrypt token to its original data\n  const token = decodeToken();\n  if (!token) {\n    return null;\n  }\n  return token.lastName;\n}\n\nexport default {\n  signin: (user) => {\n    console.log(user)\n    return fetch('/user/signin', {\n      method: 'post',\n      body: JSON.stringify(user),\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    }).then((res) => {\n      if (res.status !== 401) return res.json().then((data) => data)\n      else return { isAuthenticated: false, user: { email: '' } }\n    })\n  },\n  signup: (user) => {\n    console.log(user)\n    return fetch('/user/signup', {\n      method: 'post',\n      body: JSON.stringify(user),\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => data)\n  },\n  signout: () => {\n    return fetch('/user/signout')\n      .then((res) => res.json())\n      .then((data) => data)\n  },\n  isAuthenticated: () => {\n    return fetch('/user/authenticated').then((res) => {\n      if (res.status !== 401) return res.json().then((data) => data)\n      else return { isAuthenticated: false, user: { username: '', role: '' } }\n    })\n  },\n}\n"]},"metadata":{},"sourceType":"module"}